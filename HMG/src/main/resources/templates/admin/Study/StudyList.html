<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<link href="css/index.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script src="https://unpkg.com/cornerstone-core/dist/cornerstone.js"></script>
	<script src="https://unpkg.com/cornerstone-tools"></script>
	<script src="https://unpkg.com/dicom-parser"></script>
	<script src="https://unpkg.com/cornerstone-wado-image-loader"></script>
	<script src="https://unpkg.com/cornerstone-tools/dist/cornerstoneTools.js"></script>
	<script src="js/StudyList.js"></script>
	<style>
		/* 컨테이너 설정 */
		.container {
			display: flex;
			height: 100vh;
		}

		/* 왼쪽 사이드바 설정 */
		.sidebar {
			width: 20%;
			background-color: #f4f4f4;
			padding: 10px;
			overflow-y: auto;
		}

		/* 오른쪽 메인 콘텐츠 설정 */
		.main-content {
			width: 80%;
			display: flex;
			flex-direction: column;
		}

		/* 오른쪽 상단 헤더 */
		.header {
			height: 20%;
			background-color: #e0e0e0;
			padding: 10px;
		}

		/* 오른쪽 하단 콘텐츠 */
		.content {
			height: 80%;
			padding: 10px;
			overflow-y: auto;
		}
	</style>
</head>

<body>
	<div class="container">
		<!-- 왼쪽 사이드바 -->
		<div class="sidebar">
			<div th:replace="~{/fragments/calendar.html :: fragment-calendar}"></div>
		</div>

		<!-- 오른쪽 영역 -->
		<div class="main-content">
			<!-- 오른쪽 상단 헤더 -->
			<div class="header">
				<div th:replace="~{/fragments/header.html :: fragment-menu}"></div>
			</div>

			<!-- 오른쪽 하단 콘텐츠 -->
			<div class="content">
				<div>
					<table>
						<tr>
							<th>검사설명</th>
							<th>장비</th>
							<th>검사날짜</th>
							<th>환자아이디</th>
							<th>환지이름</th>
							<th>환자성별</th>
							<th>환자생일</th>
							<th>시리즈건수</th>
							<th>이미지건수</th>
							<th>판독결과</th>
						</tr>
						<tr th:each="study : ${study}"
							th:ondblclick="|location.href='@{/ImageTabList(studyKey=${study.studyKey})}'|"
							th:data-pid="${study.pid}" th:data-pname="${study.pname}" th:data-studyKey="${study.studyKey}"
							onclick="studyPast(this)">
							<td th:text="${study.studyDesc}!= null ? ${study.studyDesc}: '이름없음'"></td>
							<td th:text="${study.modality}"></td>
							<td th:text="${study.studyDate}"></td>
							<td th:text="${study.pid}"></td>
							<td th:text="${study.pname}"></td>
							<td th:text="${study.psex}"></td>
							<td th:text="${study.pBirthDateTime}"></td>
							<td th:text="${study.seriesCnt}"></td>
							<td th:text="${study.imageCnt}"></td>
							<td th:text="${study.reportStatus}==3 ? '읽지않음' : (${study.reportStatus}==5 ? '예비판독' : '판독')">
							</td>
						</tr>
					</table>
					<div>
						<a th:if="${nowPage > 0}" th:href="@{StudyTabList(nowPage=${nowPage-1})}">이전</a>
						<span th:text="${nowPage+1}"></span>
						<a th:if="${nowPage < totalPages}" th:href="@{StudyTabList(nowPage=${nowPage+1})}">다음</a>
					</div>
				</div>

				<div>
					<h3>과거 검사 이력</h3>
					<div>환자 아이디: <span id="pid"></span>&emsp; 환자 이름: <span id="pname"></span></div>
					<table class="study-history-table">
						<tr>
							<th>검사장비</th>
							<th>검사설명</th>
							<th>검사일시</th>
							<th>판독상태</th>
							<th>시리즈</th>
							<th>이미지</th>
						</tr>
						<tbody id="studyPastList"></tbody>
					</table>
				</div>

				<div>
					<div class="study-viewer-container" id="dicomViewer" th:ondblclick="imageTabList()"></div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>
